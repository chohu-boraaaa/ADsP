# 통계분석 section 1~3

## 1. 자료분석

### 1. 자료분석
* 변수(Variable) : 값이 달라질 수 있는 것 ex. 혈압, 나이, 키
* 상수(Constant) : 값이 달라지지 않는 것
* 관측치 : 모집단으로 추출된 표본의 수

#### R에서 자료분석하기
* dim() 함수 사용하면 관측치와 변수 개수 확인 가능
* head() 함수는 상위 데이터 조회해서 화면에 출력
* str() 함수 : 변수리스트와 변수의 데이터 타입(int:정수, num:실수, factor : 범주형) 확인 가능

### 2. 변수
* 속성을 수량화할 수 있는지 여부에 따라 양적변수와 질적변수로 구분
> 질적변수 : 명목변수, 서열변수 / 양적변수 : 등간변수, 비 변수
* 변수가 어떤 값이라도 가질 수 있는지 혹은 특정 수치만 가질 수 있는지에 따라 연속변수와 비연속변수로 구분
* 변수들 간의 상호연관성, 즉 인과관계가 있는지에 따라 독립변수와 종속변수로 구분

#### 2-1. 독립변수와 종속변수
* 독립변수 : 설명변수로 원인이 되는 변수
* 종속변수 : 결과변수로 독립변수에 영향을 받아서 결과가 되는 변수

#### 2-2. 질적변수와 양적변수
* 질적변수 : 수치로 나타낼 수 없는 변수, 빈도분석 필요 ex. 회사명, 직종, 혈액형, 성별 등
* 양적변수 : 수치로 나타낼 수 있는 변수, 평균 및 분산등으로 계산 가능 ex. 체중, 온도, 키 등

#### 2-3. 이산변수와 연속변수
* 이산변수 : 하나하나 셀 수 있는 정수 값을 가지고 있는 변수 ex. 학생 수, 직원 수
* 연속변수 : 소수점 이하의 값을 가질 수 있는 변수 ex. 온도, 체중

#### 2-4. 명목변수와 서열변수
* 명목변수 : 자료를 서로 다른 범주로 구분, 각 범주에 수치 부여 ex. 남성은 1, 여성은 2
* 서열변수 : 자료에 서열을 매기기 위해 사용되는 변수 ex. 만족은 1, 보통은 2, 불만족은 3

#### 2-5. 등간변수와 비변수(비율변수)
* 등간변수 : 자료를 서열 뿐만 아니라 상대적 차이까지 계산 ex. 온도 20도와 30도의 차이는 10도
* 비율변수 : 자료를 분류, 서열, 차이와 함께 절대영점까지 표현 ex. 키 180cm=90cm*2배

## 2. 표본조사
* 표본조사(Sample)란 모집단의 특성을 나타내는 일부 표본을 추출하기 위해 자료를 수집하는 행위
* 모집단의 대상이 너무 많기 때문에 전수조사를 하는 것은 불가능하므로 표본조사
* 모집단을 전수조사 하는 것이 오히려 표본조사보다 오차가 클 수 있음

### 1. 확률표집
* 수학적인 지침에 의해서 선정되는 표본추출
* 표본의 오차를 계산해야 함

#### 1-1. 단순무작위표집
- 랜덤하게 모수에서 표본을 반복적으로 추출하는 것으로 난수표 및 체계적 표집법을 사용
> 난수표 : 표준 프레임에 일련번호를 부여하고 컴퓨터를 사용해서 난수를 만들고 생성된 난수에 해당하는 개체를 조사 / 체계적 표집법 : 표준 프레임에 일련번호를 부여하고 추출간격 설정 후 난수에 추출 간격을 더해서 추출하는 방법

#### 1-2. 층화표집법
- 모집단을 기준에 따라 소집단으로 분류하고 각 소집단으로부터 무작위로 표본을 추출하는 방법
- 모집단에 대한 특성 이해 필요, 소집단 구분에 많은 비용과 노력 발생
- 발생비율이 낮은 소집단은 해당 표본을 찾기 어려운 문제 있음

#### 1-3. 군집표집법
- 모집단을 특정 군집으로 분류하고 군집 중 일부를 선택해서 군집의 모든 구성원을 전수조사 하는 방법
- 장점 : 조사에 소요되는 비용 및 시간 단축
- 단점 : 선출된 군집의 수가 적거나 군집 내 개체들이 지나치게 동질성을 가지면 모집단을 충분히 반영 불가

### 2. 비확률표집법
* 수학적으로 계산할 수 없는 경우에 사용되는 표본추출법
* 표본의 오차를 계산할 수 없음

#### 2-1. 편의표본추출법
- 가장 간단한 형태로 임의의 선정지역, 조사시간 등을 정의해 표본을 선택
- 표본추출 비용이 거의 발생하지 않고 조사가 간단
- 추출된 표본이 모집단을 대표하지 못함
- 응답거부자의 특성이 반영되지 않음

#### 2-2. 판단표본추출법
- 모집단의 의견을 반영할 수 있을 것이라고 판단될 때 사용하는 방법
- 조사문제에 대해 잘 알고 있을 때 사용
- 적은 비용으로 의미 있는 자료를 수집할 수 있음
- 모집단의 성격을 대표하지 못할 수 있음

#### 2-3. 할당표본추출법
- 사전에 정해놓은 분류 기준에 의해 집단을 소집단으로 분류하고 집단별 대상을 선정
- 가장 널리 사용되는 방법은 모집단의 특성이 잘 반영되도록 특성별로 비례하게 표본 추출
- 마케팅 조사, 연령별, 성별 설문조사에 사용

## 3. 기술통계

### 1. 기술통계
* 모집단으로부터 수집된 자료를 정리, 요약하여 자료의 특징을 분석
* 표 및 그래프, 객관적인 수치 사용해서 요약

### 2. 질적자료 기술통계 요약

#### 2-1. 도수분포표
- 수집된 자료에 대해서 적절한 등급으로 분류해서 정리한 표
- 각 자료에 대해서 출현 빈도를 계산하고 여러 구간으로 분류한 표
- 관측값을 여러 개의 그룹으로 나누고 관측값의 수를 요약 정리
- 도수분포표를 사용해서 막대 그래프 그림
![도수분포표](https://slidesplayer.org/slide/14920117/91/images/15/%EC%A7%88%EC%A0%81+%EC%9E%90%EB%A3%8C%EC%9D%98+%EC%A0%95%EB%A6%AC+%EB%8F%84%EC%88%98%EB%B6%84%ED%8F%AC%ED%91%9C+9%2F22%EB%AA%A9+%EC%B2%AB%EC%A7%B8+%EC%97%B4%EC%97%90%EB%8A%94+%EC%9E%90%EB%A3%8C%EC%9D%98+%EB%B2%94%EC%A3%BC%28%EA%B3%84%EA%B8%89%29%EB%A5%BC+%EC%A0%81%EA%B3%A0+%EB%91%98%EC%A7%B8+%EC%97%B4%EC%97%90%EB%8A%94+%EA%B0%81+%EB%B2%94%EC%A3%BC%EC%97%90+%ED%95%B4%EB%8B%B9%ED%95%98%EB%8A%94+%EB%8F%84%EC%88%98%EB%A5%BC+%EC%A0%81%EB%8A%94%EB%8B%A4..jpg)
출처 : https://slidesplayer.org/slide/14920117/

#### 2-2. 분할표
- 질적변수가 2개일 때 관측치를 몇 개의 그룹으로 분할해서 빈도수를 정리한 것

### 3. 연속자료 기술통계 요약

#### 3-1. 연속자료 기술통계
- 자료 분포 특성을 파악하기 위해 숫자로 표현
- 중심위치와 산포경향을 파악하여 요약

#### 3-2. 중심위치
- 평균은 자료 분포 상 무게중심 역할
- 평균의 문제점 : 데이터 분포에 다라 역할을 못할 수 있음
- 오른쪽으로 꼬리 긴 경우 : 최빈값<중앙값<평균
- 왼쪽으로 꼬리 긴 경우 : 평균<중앙값<최빈값
- 정규분포 : 평균=중앙값=최빈값

##### 1> 평균, 중앙값, 최빈값의 차이점
- 평균 : 자료의 합을 개수로 나눈 값
> 장점 : 자료의 값을 모두 사용 / 단점 : 극단적인 값이 있으면 자료의 특성을 반영하지 못함
- 중앙값 : 작은 값부터 큰 값을 나열 할 때 중앙에 있는 값, 좌우의 분포 면적 같음 
> 장점 : 극단적인 값이 있을 때 자료의 특성 잘 반영, 단점 : 모든 자료를 사용하지 않음
- 최빈값 : 자료 중 빈도가 가장 많이 나타나는 값, 빈도수가 동일한 자료가 있을 수 있어 유일하지 않을 수 있음
> 장점 : 쉽게 계산 가능 / 단점 : 자료의 수가 적으면 중심 경향을 잘 반영하지 못함

##### 2> 산술평균
- 전체 합계를 개수로 나눈 값

##### 3> 가중평균
- 평균을 계산할 때 자료의 중요도 및 영향 등에 따라 가중치를 반영한 평균값
- ![가중평균](https://i.ytimg.com/vi/BK3IdelNtoA/hqdefault.jpg)
- 출처 : https://www.youtube.com/watch?v=BK3IdelNtoA

##### 4> 기하평균
- 연간 경제성장률, 물가 인상율, 연간 이자율 등과 같은 곳에 사용됨
- 변화량 계산에 많이 사용
- ex. 2010년부터 2020년까지의 경제성장률에 대한 평균 -> 2010년의 경제 성장률이 2020년의 경제 성장률이 되려면 매년 평균 몇 퍼센트가 증가해야 하는가를 의미
- ![기하평균](https://blog.kakaocdn.net/dn/eqokbu/btqzfPxny5b/6pf5onBW7u2nyl9u78qK7k/img.png)
- 출처 : https://netpilgrim.net/1457
- ex. 모 회사에 투자하여 첫해에 10%, 둘째 해에 50%, 셋째 해에 30%의 수익을 올렸다면 3년간 평균 수익률은?
- (1.1*1.5*1.3)^1/3 - 1 = (2.415)^1/3 - 1 = 1.289 - 1 = 0.289 = 29%

##### 5> 조화평균
- 여러 단위가 결합될 때 평균적인 변화를 계산
- 상대적인 비 계산
- ![조화평균](https://img1.daumcdn.net/thumb/R720x0.q80/?scode=mtistory2&fname=http%3A%2F%2Fcfile6.uf.tistory.com%2Fimage%2F2509C64B56192AE7260D33)
- 출처 : https://rfriend.tistory.com/121
- ex. 경기도에서 서울까지 자동차로 다녀왔는데 갈 때는 고속도로를 이용하여 100km/h로 갔고 올 때는 국도를 이용해서 70km/h로 돌아왔다면 왕복 평균 속도는?
- 2/(1/100+1/70) = 2/(0.0143+0.01) = 2/0.0243 = 82.3 km/h

##### 6> 절단평균
- 너무 큰 값과 작은 값이 존재하면 평균값은 부정확해질 수 있음
- 가장 큰 값과 작은 값을 잘라내고 산술평균을 구하는 것

#### 3-3. 산포경향

##### 1> 범위
- 자료의 최대 값에서 최소 값을 뺀 것
- 이상 값에 민감하게 영향을 받음
- 범위를 사용 못하는 이유 : 최대 값에서 최소 값을 빼기 때문에 자료의 변동 확인 불가

##### 2> 분산
- 자료가 평균을 중심으로 얼마나 분포하고 있는가를 하나의 수치로 나타내는 통계량
- 확률변수가 기대값으로부터 얼마나 떨어진 곳에 분포하는지 나타내는 숫자
- ![분산공식](https://t1.daumcdn.net/cfile/tistory/23256E335880155A24)
- 출처 : https://mark2win.blogspot.com/2020/03/blog-post_60.html

##### 3> 표준편차
- 평균을 중심으로 자료가 흩어진 정도
- 자료의 분포와 변동에 대하 정보 제공
- 표준편차는 분산 값을 루트를 사용해서 값을 작게 만듦
- 용도 : 분포와 변동에 대한 정보 제공, 이상치 점검, 가설검정

##### 4> 평균, 분산, 표준편차의 차이
- 평균으로부터 얼마나 떨어져 있는지 알기 위해서는 표준편차를 구해야 하고 표준편차를 구하려면 먼저 편차를 구해야 함
- 편차 : 평균과의 차이, 편차들의 합은 0

##### 5> 체비쇼프의 정리
- 어떤 k에 대해서 적어도 자료의 (1-(1/2k)) 만큼의 비율의 k 표준편차 내에 있음
- k=2 이면 3/4인 75% 자료가 2 표준편차 내에 있음
- k=3 이면 5/6인 88.9%의 바료가 3 표준편차 내에 있음

##### 6> 변이계수
- 측정 단위가 다른 자료나 자료 값의 차이가 너무 큰 경우 사용
- 다른 말로 상대 표준편차라고도 함
- 즉, 상대적인 산포를 계산
- ![변이계수](https://blog.kakaocdn.net/dn/B8w9x/btqX0qupDDl/YFdoKHK7EiOAyAx8SHQvV1/img.png)
- 출처 : https://morison.tistory.com/24

### 4. 그래프

#### 4-1. 히스토그램
- 각 구간별 현황 및 대칭 여부 확인
- 이상값 유무 확인
- R 코드
- x2 <- rnorm(10000)
- hist(x2)

#### 4-2. 상자 그림
- 대칭여부, 이상값, 자료의 분포를 확인 가능
- 최대값, 최소값, 중위값 및 이상값 확인 가능
- 사분위범위(IQR) : 제3사분위수 - 제1사분위수(Q3-Q1)
- 박스의 길이가 길면 자료가 넓게 퍼져 있는 것

#### 4-3. 시계열 분석
- 관측치가 시간적 순서를 가지고 있음
- 주가, 환율, 거래량 변동, 기온, 습도 변화 등의 데이터
- 시계열 데이터를 사용해서 추세분석, 원인 예측, 전망 등을 분석
- 목적 : 미래 예측
- 시계열 데이터 구성요소
> 추세 : 장기간에 걸쳐 일정한 방향으로 지속적으로 상승하거나 하강하는 경향

> 계절적 변동 : 봄, 여름, 가을, 겨울에 따라서 특정 소비가 증가하거나 감소하는 형태

> 주기적 변경 : 경기동향, 실업률, 이자율과 같이 일정한 주기를 가지고 장기간에 걸쳐 변동되는 형태

> 임의변동 : 불규칙 변동, 우연한 요인에 의해 발생되기 때문에 패턴이 없음

- 추세 분해 방법
> Lowess/Loess 회귀 : 특정 범위에 다항 회귀선을 구하여 병합하는 방법

> 이동평균 : 특정 기간 동안의 값의 평균변화 분석

##### 1> 시계열 예측분석
고전적 방법
* 평활법 : 이동평균법(단순, 가중, 선형), 지수분할법(계절모형, 비계절모형)
* 분해분석법

확률적 방법
* 시간영역(AR, MA, ARIMA)
* 주파수영역

###### 1-1> 단순이동평균
- 평활법 : 불규칙한 변동을 평탄하게 예측값 구하는 방법
- 이동평균 중에서 추세가 없는 경우 적용
- 시계열의 평균수준이 시간과 관계없이 변하지 않고 단지 불규칙 변동만을 포함하는 수평적 시계열 데이터에 적용
- 과거 시계열 데이터를 연속적으로 산술평균하여 예측
- m 기간 동안의 자료의 평균을 예측값으로 추정

###### 1-2> 가중이동평균
- 단순 이동평균에 가중치가 반영된 것으로 m 기간으로 설정하면 m 기간의 값에 가중치를 곱해서 예측값이 m+1 기간에 나타남
- 시계열의 평균수준이 시간과 관계없이 변하지 않고 단지 불규칙 변동만으로 포함하는 수평적 시계열 데이터에 적용

###### 1-3> 지수평활법
- 가중 이동평균과 매우 유사하지만 가중치가 과거로 올라갈수록 지수함수적으로 감소
- 과거의 모든 자료를 사용하고 장기적인 추세가 있는 경우에 사용
- 계절모형과 비계절모형으로 나눔

###### 1-4> 자기회귀모델
- 자기회귀 : 자기 자신에 대한 변수의 회귀
- 목표변수들의 선형조합을 이용하여 관심 변수를 예측하는 방법
- 변수들의 과거 값에 대해 선형조합을 사용해서 관심 변수를 예측

###### 1-5> 자기상관모형(AR)
- 자기상관 : 어떤 랜덤 변수에 대해서 이전의 값이 이후의 값에 미치는 상황

###### 1-6> 백색잡음
- 잡음 : 시계열 데이터에서 특정 기준시점을 지정하고 기준시점과 이전과의 차이
- 평균, 분산, 자기공분산이 일정한 정상성 데이터
- 자기상관이 없는 시계열

##### 2> 안정적 시계열
- 비정상성 시계열을 정상성 데이터로 변화하여 분석해야 함

###### 2-1> 정적 데이터(정상성 데이터)
- 평균, 분산 일정
- 뚜렷한 추세 X
- 시간이 지나도 분포도에 변화 X
- 단지 시차에만 의존하고 실제의 특정 시점에는 의존하지 않아야 함
- 평균 일정하지 않은 경우 : 차분 통해 평균 정상화
- 분산 일정하지 않은 경우 : 변환 통해 분산 정상화
- 차분 : 현 시점 자료에서 전 시점 자료를 빼는 것

###### 2-2> 정적 데이터 모델링
* 자기회귀모델(AR)
> 과거와 현재의 자신과의 관계를 정의한 것

> t 시점의 값은 이전 특정 시점의 값에 영향을 줌

> 자기상관함수, 자기부분 상관함수 사용

> ![AR모형](https://search.pstatic.net/common/?src=http%3A%2F%2Fblogfiles.naver.net%2FMjAyMDA5MDFfMjQ3%2FMDAxNTk4OTI3NzMxNTYz.TZ8qkvaOdd2WT4V5ZVjh4W_7bGyfSUyoS4RTix0I-90g.9Ge_JiQ0m4YUpTI47pXfKIw3spkDO5DL850Wxmt2ySkg.PNG.tjgml1343%2F1.png&type=sc960_832)

> 출처 : https://blog.naver.com/tjgml1343/222077619748

> AR(n) : p 에 특정한 숫자 n을 대입하여 n 이전 시점부터 회귀

> cf) 시계열 간 확률적 독립인 경우 강한 백색 잡음 과정, 정규 분포인 경우 가우시안 백색 잡음 과정

* 이동평균모델(MA)
> 과거와 현재 자신의 오차와의 관계를 정의한 것

> t 시점과 이전 시점들 사건의 영향의 가중평균

> 일반적으로 오래된 사건은 영향도가 낮아짐

> ![MA모형](https://search.pstatic.net/common/?src=http%3A%2F%2Fblogfiles.naver.net%2FMjAyMDA5MDFfMTY4%2FMDAxNTk4OTMzNjc4NTcw.f2_fbKB4v0iTuXfAntN7fjtV77RLCIzsT7ZhmCoX5DMg.VmzDccDltlndJxzrzdE5y-WVSdSy6JrzQ00nJ5K-wz8g.PNG.tjgml1343%2F2.png&type=sc960_832)

> 출처 : https://blog.naver.com/tjgml1343/222077619748

> 이전항의 '오차'에서 현재 항의 상태 추론

* 자기회귀 이동평균 모델(ARMA)
> 이전항의 상태와 오차에서 현재 상태를 추론

> 자기 연관성과 자기 회귀성을 검사

* 각 모형 정리

![모형정리](https://search.pstatic.net/common/?src=http%3A%2F%2Fblogfiles.naver.net%2FMjAyMDEwMTlfMjcy%2FMDAxNjAzMTEyMjEzMzYx.ZVgpBxo695pz6COTPxEOruNl4P-A7xPw20hi-QO-ssUg.SVmlPYtv32TNYCsd05zW_pNEgIpPEVdnIFrpzWlCLoEg.PNG.jiyong615%2Fimage.png&type=sc960_832)

출처 : https://blog.naver.com/jiyong615/222120526563

###### 2-3> 비정적(비정상적) 데이터
* 자기회귀 누적 이동평균 모델(ARIMA)
> 현재와 추세간의 관계 정의, 과거 관측값과 오차를 사용해서 현재 시계열 값을 설명

> 차분과 변환을 통해 AR, MA, ARMA 등으로 정상화 가능

> 변동의 형태 파악하여 예측이 가능한 장점

> 채권시장, 증권시장에 많이 이용됨

> ARIMA(p, d, q)

> p=0 이면 IMA(d, q) -> d번 차분하면 MA(q)

> d=0 이면 ARMA(p, q) -> 정상성 만족

> q=0 이면 ARI(p,d) -> d번 차분하면 AR(p)

> 최적의 p, d, q는 자기 상관 함수(ACF), 편자기 상관 함수(PACF)를 사용하여 찾아야 함

![ARIMA](https://search.pstatic.net/common/?src=http%3A%2F%2Fblogfiles.naver.net%2FMjAyMDEwMjVfMjUx%2FMDAxNjAzNjI3NTAyNTUy.hrtZNlV6bMdc78CNkSphOHT72JToR6ZelkKfx2AjZDwg.bl7j3qEEpDx164x8PU5JMxy91Vri3pXntXWOxzy8PT4g.PNG.jiyong615%2Fimage.png&type=sc960_832)

출처 : https://blog.naver.com/jiyong615/222126244519

* 자기 상관 함수(ACF)
> k시간 단위로 구분된 시계열의 관측치 간 상관 관계 함수

> k가 1, 2, 3, ... 일 때 k 단계 떨어진 데이터 점 쌍 간들의 상관 관계

![ACF](https://i.stack.imgur.com/bNX50.png)

출처 : https://stackoverflow.com/questions/40216373/how-to-interpret-acf-plot-y-axis-scale-in-r

> 점선 바깥쪽은 유의미한 상관을 의미

> 따라서 위의 그래프에서 MA 계수가 2개 필요할 것이라고 예상 가능 (MA(2))

* 편자기 상관 함수(PACF)
> 부분(편) 상관 : 두 확률변수 X와 Y에 의해 다른 모든 변수들에 나타난 상관 관계를 설명하고 난 이후에도 여전히 남아있는 상관관계

> 시계열 관측치 간 상관 관계 함수

> 시차 k에서의 k단계 만큼 떨어져 있는 모든 데이터 점들간의 상관 관계

![PACF](https://s3-ap-northeast-2.amazonaws.com/opentutorials-user-file/module/4404/11615.png)

출처 : https://www.opentutorials.org/module/4404/27009

> 점선 바깥쪽은 유의미한 상관을 의미

> 따라서 위의 그래프에서는 AR 계수가 1개 필요할 것이라고 예상 가능(AR(1))

* 최적의 차수를 구하고 차분을 진행한 후에도 여러 모델 존재할 경우 가장 간단한 모델 선택하거나 AIC 점수 가장 낮은 모델 선택
