## 4. 추리통계

### 1. 확률
* 어떤 사건이 발생할 가능성, 0과 1 사이 숫자
* 표본 자료를 사용해서 구한 통계량과 모집단의 모수를 추론

#### 확률의 정의
- 고전적 : 이론적인 확률
- 경험적 : 실험을 통해 얻어진 확률 ex. 제품을 제작할 때 발생될 수 있는 불량품
- 주관적 : 전문가의 의견으로 주관적으로 판단되는 확률

### 2. 확률 계산
* 확률 = 사건이 발생할 경우의 수 / 전체 경우의 수

#### 1> 표본공간 : S로 표시, 통계적 시험에서 발생할 수 있는 경우의 수

#### 2> 사건 : 특정 결과가 발생하는 모임

### 3. 카운팅과 규칙
* 카운팅 : 사건이 발생할 수 있는 경우의 수 계산, 곱셈의 법칙을 사용하여 계산 ex. k번 실험의 결과 n1*n2*n3*...*nk

#### 카운팅 방법
- 사장 10명, 사원 3명, 대리 5명 근무하는 경우 각 대표를 1명으로 총 3명의 위원회가 열리는 경우의 수 : 10*3*5=150
- 남자 4명, 여자 5명이 만날 때 짝이 될 수 있는 경우의 수 : 4*5=20

### 4. 순열
- 서로 다른 n개 중 r개를 선택해서 순서를 고려후 나열하는 방법의 수
- n 팩토리얼 사용

### 5. 조합
- 서로 다른 n개의 원소에서 순서에 관계 없이 r을 뽑는 경우 n개에서 r개를 선택하는 조합
- nCr

### 6. 추리통계
* 기술적 통계에서 자료의 특성이 분석되면 표본을 사용하여 모집단의 특성을 추정하는 분석
* 확률을 사용해서 모수와 표본 간의 오차범위 예측
* 추리통계학 작업
> 가설형태, 통계적 결정오류 및 통계적 유의도, 가설검증
* 추리 통계에 대한 검증 방법
> 모수통계 검증 방법 : T-test, ANOVA, Z 검증 방법

> 비모수통계 검증 방법 : X^2 검증, Mann-Whitney U 검증, Kruskal-Wallis 검증

## 5. 통계적 추론

### 1. 확률분포
* 확률분포 : 확률변수가 특정 값을 가질 확률을 나타내는 함수, 어떤 종류의 값을 가지고 있는가에 따라 이산확률분포와 연속확률분포로 구분, 통계량 분석하여 통계적 의사결정 내릴 수 있는 기준 제시
* 확률변수 : 일정 확률을 가지고 발생하는 사건에 여러가지 값을 부여한 변수, 표본공간에 있는 각 원소에 대응하는 규칙 혹은 함수

#### 1-1. 확률분포의 종류
- 이산확률분포(정수) : 일양균등분포, 이항분포, 포아송분포, 초기하분포, 기하분포 ex. 방문자수, 교통사고 건수 등
- 연속확률분포(실수) : 평균분포 - 정규분포, t분포 / 분산분포 - 카이제곱분포, f분포 ex. 몸무게, 체온, 출근/퇴근 시간 등

#### 1-2. 확률변수와 확률분포와의 관계
- 확률변수는 모든 원소를 실수로 대응하는 함수, 확률분포는 확률변수로 얻어진 실수를 확률 값으로 변환하는 함수
- 확률변수와 확률분포를 사용해서 실행결과를 실수 혹은 발생확률로 변환 가능

### 2. 이산확률분포
* 종류 : 이산균등분포, 포아송분포, 베르누이분포, 기하분포, 초기하분포, 이항분포, 음의 이항분포, 다항분포 등
* 확률변수가 0, 1, 2 처럼 이산적인 형태를 이룸
* ex. 로또 1등이 될 확률, 1남 9녀가 될 확률

#### 2-1. 이산확률변수
- 특정 수치만을 가지고 있는 확률변수로 정수로 표현

#### 2-2. 이항분포
- 베르누이 과정의 시행을 반복
- 베르누이 시행 : 두 가지 결과 중 하나만 나타나게 시행하는 것 -> 성공 혹은 실패
- 이전이 시행결과에 독립적이므로 영향을 주지 않음
- 각 시행의 성공 혹은 실패의 확률은 끝까지 변하지 않음
- ![이항분포](https://mblogthumb-phinf.pstatic.net/20160421_279/padosori60_1461237695661tkd6d_PNG/2.PNG?type=w800)
- 출처 : https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=padosori60&logNo=220689797057
- 베르누이 분포
> 베르누이 분포는 확률변수가 0과 1의 두가지 결과 값만을 가지고 서로 독립적으로 시행

> 모든 실험결과에서 결과확률은 항상 동일

cf) 평균과 기대값의 차이점 : 평균은 전체 값에 대한 중간 값이지만 기대값은 확률분포를 가지고 있는 각각의 결과를 확률의 계산을 통해서 결과값들의 평균을 예측하는 값

#### 2-3. 포아송분포
- 데이터 분석자가 설정한 시간에서 사건이 발생하는 건수
- 일정한 시간, 거리, 공간 범위에서 발생할 확률이 매우 낮은 사건들의 발생 확률을 계산할 때 사용되는 분포
- 시간 단위 당 도착에 대한 모델에 많이 사용됨
- ![포아송분포](https://image3.slideserve.com/5718810/slide34-l.jpg)
- 출처 : https://www.slideserve.com/waite/5718810
- λ: 해당 구간에서 사건이 발생하는 수의 평균값, x: 발생하는 사건의 수
- ex. 일정한 거리의 전선에서 결점 수, 생산 공장에서 작업 중에 재해가 발생하여 사망할 건수, 주어진 기간 동안 살인 사건의 수
- 지수분포
> 포아송분포의 반대로 도착시간에 따른 시간을 측정할 때 사용하는 연속확률분포

> 두 사건 사이에서 시간에 대한 확률

> ![지수분포](https://t1.daumcdn.net/cfile/tistory/2358ED3B56001C373B)

#### 2-4. 기하분포
- ![기하분포](https://slidesplayer.org/slide/14063420/86/images/28/%C2%A74.5+%EA%B8%B0%ED%95%98%EB%B6%84%ED%8F%AC%EC%99%80+%EC%9D%8C%EC%9D%B4%ED%95%AD%EB%B6%84%ED%8F%AC+%EA%B8%B0%ED%95%98%EB%B6%84%ED%8F%AC+%EC%B2%AB%EB%B2%88%EC%A7%B8+%EC%84%B1%EA%B3%B5%28+s+%29%EC%9D%B4+%EB%82%98%EC%98%AC+%EB%95%8C+%EA%B9%8C%EC%A7%80+%EB%B2%A0%EB%A5%B4%EB%88%84%EC%9D%B4+%EC%8B%9C%ED%96%89+%EB%B0%98%EB%B3%B5.jpg)
- 출처 : https://slidesplayer.org/slide/14063420/
- ![기하분포기댓값](https://mblogthumb-phinf.pstatic.net/MjAxNjExMjNfODQg/MDAxNDc5ODk5MjU0MzA3.OEhh38cXSBscf-FwNMZC8R2MG4N-ZT-SJyYX-NwNcVEg.Fx8hZGUnh01PuHdhAB5fIpDOfcs5Pdun5n7R8fe5Ozgg.JPEG.victor3dh/11.jpg?type=w800)
- 출처 : https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=victor3dh&logNo=220869063740

#### 2-5. 초기하분포
- 주어진 횟수만큼 반복되는 경우성공할 횟수 예측
- 이항확률분포는 연속되는 시행이 독립적이지만 초기하분포에서는 과거의 결과는 현재, 미래의 결과에 영향을 미치는 것으로 분석
- 초기하분포는 시행마다 발생할 결과가 이항분포처럼 두 가지만 있지만 유한 모집단에서 비복원 추출되기 때문에 베르누이 시행조건에 만족되지 않을 경우 사용되는 확률분포
- 베르누이 과정을 따르지 않음
- ![초기하분포](https://mblogthumb-phinf.pstatic.net/20160525_214/padosori60_1464162823229gIPXL_PNG/1.PNG?type=w800)
- 출처 : https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=padosori60&logNo=220719065580

#### 2-6. 음이항분포
- 확률변수 X가 모수 (r,p)인 음이항 분포를 따른다고 하면 {X=k}, (k=r, r+1, r+2, ...)는 k번째 시행은 성공이어야 하고 그 앞의 (k-1) 번째 시행중에서 (r-1)번의 성공과 (k-r)번의 실패가 일어나는 것과 같은 사건
- ![음이항분포](https://artificialnetworkforstarters.readthedocs.io/en/latest/_images/%EC%9D%8C%EC%9D%B4%ED%95%AD%EB%B6%84%ED%8F%AC_%EC%8B%9D.png)
- 출처 : https://artificialnetworkforstarters.readthedocs.io/en/latest/_post/chap6.html
- ![음이항분포 기댓값](https://search.pstatic.net/common/?src=http%3A%2F%2Fblogfiles.naver.net%2FMjAyMDEyMDRfMTg4%2FMDAxNjA3MDQ1Mjk5Njg4.CkuXrRcxFfAW0KSVhQWhgsHBPXsaI8fsBpGibhK-X2Eg.eZW77C5GrKJg8YtlsoZVIy701ZBy2b_W68VEKdgqmO4g.PNG.jaurim1011%2Fimage.png&type=sc960_832)
- 출처 : https://blog.naver.com/jaurim1011/222162473173

### 3. 연속확률분포
- 확률 밀도 함수를 사용해서 분포 표현 가능
- 정규분포, 연속균등분포, t분포, F분포, 카이제곱 분포, 감마분포가 있음

#### 3-1. 연속확률변수
- 어떤 범위에서 연속적인 값을 가질 수 있는 실수
- 연속확률변수의 자료는 각각 고유의 값을 가지고 있음

#### 3-2. 정규분포
- 샘플을 추출해서 모집단의 모수를 예측할 때 사용
- 모집단의 분포를 정규분포로 가정하고 통계분석 수행
- 정규분포는 평균을 중심으로 좌우대칭 구조를 가지고 있는 확률분포
- 표준 확률변수 : 측정단위와 관계 없이 자료를 표준화시킴, 평균으로부터 떨어진 거리 계산 가능

#### 3-3. 경험적 법칙
- z = 1.65, 신뢰도 90%
- z = 1.96, 신뢰도 95%
- z = 2.58, 신뢰도 99%

### 4. 통계적 추론방법
* 통계적 추론 : 우리가 알지 못하는 대상에 대해서 통계적으로 접근하여 알아가는 과정

#### 4-1. 모수적 추론
- 어떤 대상인 모집단의 분포가 어떤 분포일 것이라고 가정한 후 모수에 대해 추론하는 방법
- 예를 들어 모집단이 정규분포를 따른다고 가정하면 분포의 모수는 평균과 분산일 것
- 모수적 추론의 가정은 최종 결론에 큰 영향
- 모수적 추론은 정규분포, 이항분포, 포아송분포 등을 가정하고 있음

#### 4-2. 비모수적 추론
- 모집단에 대해서 어떠한 가정도 하지 않고 추론하는 것
- 모집단을 몇 개의 모수로 결정하기 어려워서 많은 모수를 사용해야 할 대 비모수적 추론을 함
- 정규분포를 가정하지 않으므로 평균과 분산이 없고 평균값의 차이, 신뢰구간 구할 수 없음
- 해석이 복잡해지고 실제 값을 사용하기보다 부호나 순위 등의 형태를 사용하는 경우가 많음
- 비모수적 추론을 사용할 때
> 정규분포를 따르지 않는 것이 증명

> 표본의 수가 적어서 정규분포를 가정할 수 없음

> 모집단에 대한 아무런 정보가 없음

##### 1> 부호검정
- 종속표본(2개) & 검정방법 : 서열척도
- 데이터 스토어에 저장된 정형 데이터 및 비정형 데이터를 분석하고 데이터 셋을 준비
- 모평균과 모중앙 값은 분포 위치를 나타내는 모수로 만약 분포형태가 대칭이면 두 모수는 일치

##### 2> Wilcoxon의 부호순위 검정
- 종속표본(k개) & 검정방법 : 서열척도
- 두 집단을 고려할 때 관측치의 크기를 무시하고 B(검정통계량)는 Mo(중앙값)을 중심으로 크고 작은 것만 고려

#### 4-3. 베이지안 추론
- 베이지안 확률을 사용해서 추론하는 방법으로 모수적 추론에서 가정한 분포의 모수로 추론
- 실험을 통해서 정보를 획득하고 베이즈 정리를 사용하여 가설 호가률을 수정하는 통계적 추론방법
- 인공지능에서 사전 데이터로부터 학습된 지식을 추가 데이터로 업데이트할 때 사용됨

##### 1> 베이즈 정리
- 독립사건 A와 B가 있을 때, A에 대해서 B의 조건부 확률 P(A|B)=P(A교B)/P(B)와 B에 대한 A의 조건부 확률 P(B|A)=P(B교A)/P(A)는 일반적으로 같지 않음
- A와 B의 사전확률인 P(A)와 P(B)가 같지 않기 때문에 같지 않다.
- 베이즈 정리는 P(A|B), P(B|A) 사이의 연관규칙이 존재하면 해당 규칙의 관계를 설명
- ![베이즈정리](https://artificialnetworkforstarters.readthedocs.io/en/latest/_images/%EB%B2%A0%EC%9D%B4%EC%A6%88%EC%A0%95%EB%A6%AC_%EC%8B%9D.png)
- 출처 : https://artificialnetworkforstarters.readthedocs.io/en/latest/_post/chap6.html
- 위의 베이즈 정리 A와 B는 모두 독립사건이고 B가 발생할 확률인 P(B)는 0이 아님
- 사건 A가 일어날 확률 P(A)와 사건 B가 일어날 확률 P(B)에서 B에 대한 A의 조건부 확률 P(B|A)를 알고 있으면 A에 대한 B가 일어날 확률을 알지 못해도 추정 가능

##### 2> 베이즈 정리를 사용한 베이지안 추론
- 베이지안 추론 : 사전 경험과 현재 데이터를 사용해서 어떤 사건의 확률을 베이즈 정리를 사용해서 추론한 것
- 앞선 P(A)는 사전확률이고 "사건 A가 발생한다"라는 명제에 대한 확률 값으로 정의
- P(B)는 증거로 측정을 통해 얻어진 B가 발생할 확률
- P(B|A)는 가능도로 "사건 A가 발생할 때 명제 B가 발생할 조건부 확률이다"
- P(B|A)와 P(A), P(B)를 통해 P(A|B)를 얻을 수 있으며 P(A|B)는 사후 확률로 B라는 증거가 관찰된 후의 명제에 대한 확률
- 베이지안 추론
> ![베이지안추론](https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2020-01-09-Bayes_rule/pic1.png)

> 출처 : https://angeloyeo.github.io/2020/01/09/Bayes_rule.html

> 사건 A가 발생한다라는 명제를 H로 정의하고 믿음의 정도는 P(H)로 나타낸다 -> P(H)는 사전확률

> 증거 B를 E로 나타냄 -> P(E)는 측정을 통해 얻어진 확률

### 5. 통계적 추론의 목적과 방법에 따른 분류
* 통계적 추론은 추정과 가설검정으로 분류
* 또, 추정은 점추정과 구간추정으로 분류

#### 5-1. 점추정
- 미지의 모수에 대해 표본의 통계량을 사용해서 어떤 값으로 추정하는 과정
- 모집단의 특성을 단일 값으로 추정하는 방법
- 대표적 예 : 표본평균, 표본분산
- 모집단의 평균이 표본평균과 일치하는 세타를 찾는 방법으로 적률방법이라고 함
- ![점추정](https://ssl.pstatic.net/images.se2/smedit/2016/11/15/ivjlfsnkhwfpn4.jpg)
- 출처 : https://blog.naver.com/PostView.nhn?isHttpsRedirect=true&blogId=mykepzzang&logNo=220862687042

#### 5-2. 구간추정
- 모수의 값이 포함될 것이라 생각되는 범위를 통해 모수를 추정
- 모수의 구간 값을 계산해서 모수가 특정 구간에 포함될 것을 확률로 분석
- 신뢰수준으로 95%, 97% 등으로 확률로 나타남
- 정규분포의 구간추정
- ![구간추정](https://blog.kakaocdn.net/dn/bJietR/btqvjMrmG7B/NFn0dFKYwkyPIzSsg2Qgrk/img.png)
- 출처 : https://bskyvision.com/489

#### 5-3. 가설검정
- 모수에 대한 가설을 세우고 해당 가설의 옳고 그름을 판단
- 가설에 대한 검정을 통해 기각할 것인지 채택할 것인지 결정
- 검정통계량은 귀무가설을 기각하고 대립가설을 채택할지 아니면 귀무가설을 채택하고 대립가설을 기각할 것인지에 대한 통계량
